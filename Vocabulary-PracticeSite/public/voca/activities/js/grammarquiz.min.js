window.addEventListener("load",(function(){!function(){"use strict";var quizObj={time:0,tchr:"",clss:"",frag:"",data:{info:{name:"Grammar Quiz",main:"",results:"",level1:"well done! You know your grammar!",level2:"you know a lot about grammar!",level3:"you have some knowledge of grammar. Keep studying!",level4:"practice more grammar!",level5:"please practice more!"},questions:[]}};function signOutOfApp(){firebase.auth().signOut()}function handlersOn(){navListenersOn(),docEl("chgSelected").addEventListener("click",updateClss,{capture:!1,passive:!0})}function convertObj(el){var qObj={};return qObj.q=el.gmr.b4+" _____ "+el.gmr.af,qObj.imc="<p>&#x2713;&nbsp;&nbsp;Correct!</p>",qObj.inc="<p>&#x2717;&nbsp;&nbsp;Incorrect!</p>",qObj.a=[{option:el.gmr.dis1,imc:!1},{option:el.gmr.dis2,imc:!1},{option:el.gmr.dis3,imc:!1},{option:el.en,imc:!0}],qObj.a=shuffleAnArray(qObj.a),qObj}function convertData(data){var qObj;data.forEach((function(el){el.hasOwnProperty("gmr")&&(qObj=convertObj(el),quizObj.data.questions.push(qObj))}))}function init(){var objExists=window.localStorage.getItem("myClss"),data=JSON.parse(objExists);if(null!==data){try{quizObj.tchr=data.tchr,quizObj.clss=data.clss,data.hasOwnProperty("frag")&&!0===chkTrk(data.frag)&&(quizObj.frag=data.frag),convertData(data.voca)}catch(e){quizObj.tchr="",quizObj.clss="",quizObj.data.questions=[],dataError()}docEl("slctdTchrTxt").textContent=quizObj.clss+" "+quizObj.tchr+" "+quizObj.frag,quizObj.data.questions.length?(quizObj.time=Date.now(),$((function(){$("#slickQuiz").slickQuiz({json:quizObj.data,events:{onCompleteQuiz:userScored}})}))):$((function(){$("#slickQuiz").slickQuiz()}))}else dataError();renderNav(),handlersOn()}function userScored(obj){var score="completed: "+obj.score+"/"+obj.questionCount,timeStamp=Date.now(),duration=timeStamp-quizObj.time;postIt({a:timeStamp,b:quizObj.tchr,c:quizObj.clss,d:quizObj.frag,e:duration,f:document.title,g:score})}function postIt(dataObj){var user=firebase.auth().currentUser,uid=user.uid,postData={email:user.email,timestamp:dataObj.a,tchr:dataObj.b,clss:dataObj.c,frag:dataObj.d,duration:dataObj.e,activity:dataObj.f,score:dataObj.g},newPostKey,updates={};updates["activities/"+uid+"/"+firebase.database().ref().child("activities/"+uid+"/").push().key]=postData,firebase.database().ref().update(updates,(function(e){e?"PERMISSION_DENIED"===e.code?signOutOfApp():window.alert("Data could not be saved.\n"+e):window.alert("Activity completed!")}))}firebase.auth().onAuthStateChanged((function(user){user?(docEl("usrPhoto").src=user.photoURL,init()):window.location="../index.html"}))}()}));