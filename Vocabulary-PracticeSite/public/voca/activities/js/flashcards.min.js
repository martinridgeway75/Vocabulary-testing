window.addEventListener("load",(function(){!function(){"use strict";var fcObj={time:0,tchr:"",clss:"",frag:"",voca:[],diy:[],idx:-1};function handlersOn(){navListenersOn(),docEl("flipper").addEventListener("click",flipCard,{capture:"false",passive:"true"}),docEl("clssVoca").addEventListener("click",restartWithClssVoca,{capture:"false",passive:"true"}),docEl("hideCRUDdiv").addEventListener("click",restartWithDIY,{capture:"false",passive:"true"}),docEl("myFlashCards").addEventListener("click",restartWithDIY,{capture:"false",passive:"true"}),docEl("showCRUDdiv").addEventListener("click",doCRUD,{capture:"false",passive:"true"}),docEl("chgSelected").addEventListener("click",updateClss,{capture:!1,passive:!0}),docEl("submit").addEventListener("click",onRegisterPressed,{capture:!1,passive:!0}),docEl("clear").addEventListener("click",onClarPressed,{capture:!1,passive:!0}),docEl("tablerows").addEventListener("click",identifyEl,{capture:!1,passive:!0})}function createCards(arr){var container=docEl("deck"),frag=document.createDocumentFragment();arr.forEach((function(el){var newLi=document.createElement("li"),newDiv1=document.createElement("div"),newDiv2=document.createElement("div"),newP1=document.createElement("p"),newP2=document.createElement("p");newLi.className="card",newDiv1.className="side_one",newDiv2.className="side_two",newP1.textContent=el.en,newP2.textContent=el.kr,newDiv1.appendChild(newP1),newDiv2.appendChild(newP2),newLi.appendChild(newDiv1),newLi.appendChild(newDiv2),frag.appendChild(newLi)})),container.appendChild(frag)}function buildDeck(propName){var arr,arrRef=fcObj[propName];emptyContent(docEl("deck")),createCards(arr=arrRef.length?shuffleAnArray(arrRef):"voca"!==propName?[{en:"Add some cards!",kr:"카드 를 추가!"}]:[{en:"No vocabulary available",kr:"데이터가 없습니다!"}])}function flipCard(){$(".card.cycle-slide-active").toggleClass("flip")}function restartCycle(propName){buildDeck(propName),$(".cycle-slideshow").cycle({fx:"shuffle",timeout:0,sync:!1,manualFx:"shuffle",shuffleTop:-200,shuffleRight:-200,next:"#next",prev:"#prev",speed:650,slides:"li",log:!1})}function restartWithClssVoca(){var txt;txt=""===fcObj.clss?"Class unknown":fcObj.clss+" "+fcObj.tchr+" "+fcObj.frag,$(".cycle-slideshow").cycle("destroy"),hideEl("showCRUD"),showEl("showCRUDdiv"),docEl("slctdTchrTxt").textContent=txt,docEl("nav_deck").style.zIndex=1,restartCycle("voca")}function restartWithDIY(){$(".cycle-slideshow").cycle("destroy"),hideEl("showCRUD"),hideEl("hideCRUDdiv"),showEl("showCRUDdiv"),docEl("slctdTchrTxt").textContent="My flashcards",docEl("nav_deck").style.zIndex=1,saveMyFlashcards(),restartCycle("diy")}function doCRUD(){hideEl("showCRUDdiv"),showEl("showCRUD"),showEl("hideCRUDdiv"),initTable()}function initTable(){emptyContent(docEl("tablerows")),fcObj.diy.length&&fcObj.diy.forEach((function(el,i){prepareTableCell(i,el.en,el.kr)}))}function onRegisterPressed(){var eng,kor,newObj={en:docEl("firstname").value,kr:docEl("lastname").value};-1===fcObj.idx?fcObj.diy.push(newObj):fcObj.diy.splice(fcObj.idx,1,newObj),initTable(),onClarPressed()}function prepareTableCell(index,firstName,lastName){var table=docEl("tablerows"),frag=document.createDocumentFragment(),row=document.createElement("tr"),engCell=document.createElement("td"),korCell=document.createElement("td"),actionCell=document.createElement("td"),a1=document.createElement("span"),a2=document.createElement("span");engCell.textContent=firstName,korCell.textContent=lastName,a1.className="btn btn-xs btn-warning",a1.id="e_"+index,a1.textContent="Edit",a2.className="btn btn-xs btn-danger",a2.id="d_"+index,a2.textContent="Delete",actionCell.appendChild(a1),actionCell.appendChild(a2),row.appendChild(engCell),row.appendChild(korCell),row.appendChild(actionCell),frag.appendChild(row),table.appendChild(frag)}function identifyEl(e){var index,el_;e.target!==e.currentTarget&&("e_"===(el_=e.target.id.substring(0,2))?onEditPressed(index=Number(e.target.id.substring(2))):"d_"===el_&&deleteTableRow(index=Number(e.target.id.substring(2)))),e.stopPropagation()}function deleteTableRow(index){fcObj.diy.splice(index,1),initTable()}function onClarPressed(){fcObj.idx=-1,docEl("firstname").value="",docEl("lastname").value="",docEl("submit").textContent="Insert"}function onEditPressed(index){fcObj.idx=index;var newObj=fcObj.diy[index];docEl("firstname").value=newObj.en,docEl("lastname").value=newObj.kr,docEl("submit").textContent="Update"}function initMyFlashcards(){var objExists=window.localStorage.getItem("myFlashcards"),data=JSON.parse(objExists);if(null!==data)try{fcObj.diy=data}catch(e){fcObj.diy=[]}}function saveMyFlashcards(){var data,i;if(fcObj.diy.length){for(i=fcObj.diy.length-1;i>=0;i--)""===fcObj.diy[i].en&&""===fcObj.diy[i].kr&&fcObj.diy.splice(i,1);data=JSON.stringify(fcObj.diy),window.localStorage.setItem("myFlashcards",data)}}function init(){var objExists=window.localStorage.getItem("myClss"),data=JSON.parse(objExists);if(null!==data)try{fcObj.tchr=data.tchr,fcObj.clss=data.clss,data.hasOwnProperty("frag")&&!0===chkTrk(data.frag)&&(fcObj.frag=data.frag),fcObj.voca=data.voca}catch(e){fcObj.tchr="",fcObj.clss="",fcObj.voca=[],dataError()}renderNav(),restartWithClssVoca(),initMyFlashcards(),handlersOn()}firebase.auth().onAuthStateChanged((function(user){user?(docEl("usrPhoto").src=user.photoURL,$(document).ready((function(){init()}))):window.location="../index.html"})),"onpagehide"in window?window.addEventListener("pagehide",saveMyFlashcards,!1):window.addEventListener("beforeunload",saveMyFlashcards,!1)}()}));