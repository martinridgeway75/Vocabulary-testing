window.addEventListener("load",function(){!function(){"use strict";var vocaObj={myClss:{tchr:"Martin Ridgeway",clss:"PE4",frag:"",voca:[]}};function docEl(elId){return document.getElementById(elId)}function signOutOfApp(){firebase.auth().signOut()}function emptyContent(parentEl){for(;parentEl.hasChildNodes();){for(;parentEl.lastChild.hasChildNodes();)parentEl.lastChild.removeChild(parentEl.lastChild.lastChild);parentEl.removeChild(parentEl.lastChild)}}function simpleHttpRequest(url,successFn){var request;try{request=new XMLHttpRequest}catch(e){return}request.open("GET",url,!0),request.onreadystatechange=function(){var container;4==request.readyState&&(200==request.status?successFn(request.responseText):(emptyContent(container=docEl("tchrBtns")),container.textContent="Cannot retrieve the information."))},request.send()}function hideEl(elId){docEl(elId).classList.contains("nodisplay")||(docEl(elId).className+=" nodisplay")}function showEl(elId){docEl(elId).className=docEl(elId).className.replace(/(?:^|\s)nodisplay(?!\S)/g,"")}function changeTchr(){docEl("vocaTxt").textContent="",hideEl("clssBtns"),hideEl("myVoca"),hideEl("trckBtn"),hideEl("trckr"),showEl("tchrBtns"),getVoca(vocaObj.myClss.tchr,vocaObj.myClss.clss)}function successVoca(response){var myVoca=JSON.parse(response);null!==(myVoca=myVoca[0].data)&&function(vocaList){var today;null!==vocaList&&Array.isArray(vocaList)&&(today=Date.now(),vocaObj.myClss.voca=vocaList.filter(function(el){return-1!==el.forClss.indexOf(vocaObj.myClss.clss)&&today>=el.availFrom&&today<=el.availTo}));!function(){docEl("infoTxt").textContent=" ",vocaObj.myClss.voca.length?(function(){var newA0,newDiv0,newDiv1,newDiv2,container=docEl("myVoca"),frag=document.createDocumentFragment();emptyContent(container),[{cat:"Information",links:[{ref:"/voca/activities/studyguide.html",name:"Study guide"},{ref:"/voca/activities/translations.html",name:"Translations"},{ref:"/voca/activities/flashcards.html",name:"Flashcards"},{ref:"/voca/activities/js/ios/Martin_Ridgeway_PE4_VOCA_PracticeTest_Spring2020.pdf",name:"Paper Practice Test"}]},{cat:"Activities",links:[{ref:"/voca/activities/matching.html",name:"Word Match"},{ref:"/voca/activities/memory.html",name:"Memory"},{ref:"/voca/activities/grammarpuzzle.html",name:"Grammar Puzzle"},{ref:"/voca/activities/collocations.html",name:"Collocation drop"},{ref:"/voca/activities/galaga.html",name:"Galaga"},{ref:"/voca/activities/h_ngm_n.html",name:"Hangman"},{ref:"/voca/activities/crossword.html",name:"Crossword"}]},{cat:"Quizzes",links:[{ref:"/voca/activities/synonymsquiz.html",name:"Synonyms"},{ref:"/voca/activities/grammarquiz.html",name:"Grammar"},{ref:"/voca/activities/collocationsquiz.html",name:"Collocations"}]}].forEach(function(elem){newDiv0=document.createElement("DIV"),newDiv1=document.createElement("DIV"),newDiv2=document.createElement("DIV"),newDiv0.className="partition",newDiv0.textContent=elem.cat,newDiv1.className="row",newDiv2.className="col-lg-12",elem.links.forEach(function(el){(newA0=document.createElement("A")).href=el.ref||"#",newA0.target="_parent",newA0.className="btn btn-purple btn-half",newA0.textContent=el.name,newDiv2.appendChild(newA0)}),newDiv1.appendChild(newDiv2),frag.appendChild(newDiv0),frag.appendChild(newDiv1)}),container.appendChild(frag)}(),function(){var nav=document.querySelectorAll(".navbar.navbar-default.navbar-unslctd")[0];void 0!==nav&&(nav.className=nav.className.replace(/(?:^|\s)navbar-unslctd(?!\S)/g,""))}(),showEl("myVoca"),docEl("vocaTxt").textContent="Ready!",showEl("trckBtn"),showEl("myVoca"),saveMyClss()):docEl("vocaTxt").textContent="No vocabulary available for this class.";docEl("slctdTchrTxt").textContent=vocaObj.myClss.clss+" "+vocaObj.myClss.tchr,hideEl("clssBtns"),hideEl("loadup")}()}(myVoca)}function getVoca(tchr){var url="../voca/activities/js/ios/"+(tchr=tchr.replace(" ","_"))+".json";hideEl("myVoca"),showEl("loadup"),simpleHttpRequest(url,successVoca)}function saveMyClss(){var data;""!==vocaObj.myClss.tchr&&""!==vocaObj.myClss.clss&&(data=JSON.stringify(vocaObj.myClss),window.localStorage.setItem("myClss",data))}function addTrkr(){docEl("cfrmTrkr").addEventListener("click",confirmTrkr,{capture:"false",passive:"true"}),docEl("clrTrkr").addEventListener("click",clearTrkr,{capture:"false",passive:"true"}),showEl("trckr"),hideEl("trckBtn")}function revertInputs(){Array.from(document.querySelectorAll("input[type='text']")).forEach(function(el){el.value=""}),docEl("trckBtn").textContent="ID"}function confirmTrkr(){var frag=function(){var vals=Array.from(document.querySelectorAll("input[type='text']")).map(function(el){return el.value}),frag=vals.join(""),n=frag.replace(/[^0-9]/gim,"").replace(/[\s\t]+/,"");return""===vals[4]&&n.length&&4===n.length?frag:""}();""!==frag?(vocaObj.myClss.frag=frag,docEl("trckBtn").textContent=frag):revertInputs(),docEl("cfrmTrkr").removeEventListener("click",confirmTrkr,{capture:"false",passive:"true"}),docEl("clrTrkr").removeEventListener("click",clearTrkr,{capture:"false",passive:"true"}),hideEl("trckr"),showEl("trckBtn")}function clearTrkr(){vocaObj.myClss.frag="",revertInputs()}firebase.auth().onAuthStateChanged(function(user){user?(docEl("usrPhoto").src=user.photoURL,user.uid,user.displayName,firebase.database().ref("chkUserPermission").once("value").then(function(snapshot){!function(){var objExists=window.localStorage.getItem("myClss"),data=JSON.parse(objExists);if(null!==data){try{vocaObj.myClss.tchr=data.tchr,vocaObj.myClss.clss=data.clss,data.hasOwnProperty("frag")&&(vocaObj.myClss.frag=data.frag),vocaObj.myClss.clss=data.clss}catch(e){vocaObj.myClss.voca=[]}showEl("slctdTchr"),showEl("chgSelected")}getVoca(vocaObj.myClss.tchr,vocaObj.myClss.clss),docEl("chgSelected").addEventListener("click",changeTchr,{capture:"false",passive:"true"}),docEl("trckBtn").addEventListener("click",addTrkr,{capture:"false",passive:"true"}),function(){var fragChars,els,frag=vocaObj.myClss.frag;if(""===frag)return docEl("trckBtn").textContent="ID";fragChars=frag.split(""),els=Array.from(docEl("trckr").querySelectorAll("input[type='text']")),docEl("trckBtn").textContent=frag,els.forEach(function(el,idx){el.value=fragChars[idx]||""})}(),"serviceWorker"in navigator&&navigator.serviceWorker.register("/voca/serviceWorker.js");vocaObj.myClss.hasOwnProperty("voca")&&("onpagehide"in window?window.addEventListener("pagehide",saveMyClss,!1):window.addEventListener("beforeunload",saveMyClss,!1))}()},function(err){!function(err){var user,updates;"PERMISSION_DENIED"===err.code&&((user=firebase.auth().currentUser)?(function(name){var container=docEl("infoTxt"),frag=document.createDocumentFragment(),newDiv0=document.createElement("DIV"),newDiv1=document.createElement("DIV"),newH2=document.createElement("H2"),newP=document.createElement("P");emptyContent(container),newDiv0.className="row contentBox",newDiv0.style.marginTop="80px",newDiv1.className="col-lg-12 text-left",newH2.textContent="Welcome",newP.textContent="Hello "+name+"! Thank you for registering.\r\nPlease sign in again to use the site.",newDiv1.appendChild(newH2),newDiv1.appendChild(newP),newDiv0.appendChild(newDiv1),frag.appendChild(newDiv0),container.appendChild(frag)}(user.displayName),(updates={})["studentUser/"+user.uid]={email:user.email,uName:user.displayName},firebase.database().ref().update(updates).then(window.setTimeout(signOutOfApp,5e3))):signOutOfApp())}(err)})):window.location="../index.html"})}()});