window.addEventListener("load",(function(){!function(){"use strict";var gmrObj={time:0,tchr:"",clss:"",frag:"",vocaList:[],gmr:{list:[],orig:[],seq:[]}};function signOutOfApp(){firebase.auth().signOut()}function handlersOn(){navListenersOn(),docEl("sentence").addEventListener("click",wordClick,{capture:!1,passive:!0}),docEl("nextQuestion").addEventListener("click",resetQuestion,{capture:!1,passive:!0}),docEl("chgSelected").addEventListener("click",updateClss,{capture:!1,passive:!0})}function displayNewQ(tempArr){var container=docEl("sentence"),frag=document.createDocumentFragment();tempArr.forEach((function(el){var newDiv1=document.createElement("div");newDiv1.id="w_"+gmrObj.gmr.orig.indexOf(el),newDiv1.className="btn btn-sm btn-whiteBlue",newDiv1.style.margin="5px",newDiv1.textContent=el,frag.appendChild(newDiv1)})),container.appendChild(frag)}function grabNewQ(){var data,tempArr=[];gmrObj.gmr.list.length?(tempArr=(data=gmrObj.gmr.list.splice(Math.floor(Math.random()*gmrObj.gmr.list.length),1)[0]).split(" "),gmrObj.gmr.orig=tempArr.slice(0),displayNewQ(tempArr=shuffleAnArray(tempArr))):showCompleted()}function showAnswer(){var orig=gmrObj.gmr.orig.join(" ");docEl("resultAnswer").textContent=orig+" âœ“",docEl("resultAnswer").style.display="block",docEl("nextQuestion").style.display="inline-block",gmrObj.gmr.list.length?docEl("arraycount").textContent=gmrObj.vocaList.length-gmrObj.gmr.list.length:docEl("arraycount").textContent=gmrObj.vocaList.length}function clearSentence(){emptyContent(docEl("sentence")),docEl("resultAnswer").style.display="none",docEl("nextQuestion").style.display="none"}function resetQuestion(){gmrObj.gmr.seq=[],clearSentence(),grabNewQ()}function showCompleted(){var len=gmrObj.gmr.list.length,vocaLen=gmrObj.vocaList.length;clearSentence(),docEl("sentence").textContent="Congratulations! You have completed all the examples!",userScored(vocaLen)}function checkSequence(el){var i;for(i=0;i<gmrObj.gmr.seq.length;i++){if(i!==gmrObj.gmr.seq[i])return gmrObj.gmr.seq=[],void reColor(el);if(gmrObj.gmr.seq.length===gmrObj.gmr.orig.length&&gmrObj.gmr.seq[i]===gmrObj.gmr.orig.length-1)return void showAnswer()}}function reColor(btn){var i;for(i=0;i<btn.children.length;i++)btn.children[i].style.backgroundColor="",btn.children[i].style.color="",btn.children[i].style.borderColor=""}function wordClick(el){if(el.target!==el.currentTarget){var elId=Number(el.target.id.substring(2));reColor(el.target),el.target.style.backgroundColor="#337ab7",el.target.style.borderColor="#2e6da4",el.target.style.color="#fff",gmrObj.gmr.seq.push(elId),checkSequence(el.currentTarget)}el.stopPropagation()}function showEmpty(){clearSentence(),docEl("sentence").textContent="No vocabulary available."}function testForDupWords(arr){for(var temp=[],i=0;i<arr.length;i++)(temp=arr[i].split(" ")).map((function(el,index,tempArr){index!==tempArr.indexOf(el)&&(tempArr[index]=el+"+")})),temp.map((function(el,index,tempArr){index!==tempArr.indexOf(el)&&(tempArr[index]=el+"+")})),arr[i]=temp.join(" ");return arr}function getSentences(voca){var arr=[],str;return voca.forEach((function(el){el.hasOwnProperty("gmr")&&(str=el.gmr.b4+" "+el.en+" "+el.gmr.af,arr.push(str))})),arr=testForDupWords(arr)}function init(){var objExists=window.localStorage.getItem("myClss"),data=JSON.parse(objExists);if(null!==data){try{gmrObj.tchr=data.tchr,gmrObj.clss=data.clss,data.hasOwnProperty("frag")&&!0===chkTrk(data.frag)&&(gmrObj.frag=data.frag),gmrObj.vocaList=getSentences(data.voca),gmrObj.gmr.list=gmrObj.vocaList.slice(0)}catch(e){gmrObj.tchr="",gmrObj.clss="",gmrObj.vocaList=[],dataError()}docEl("slctdTchrTxt").textContent=gmrObj.clss+" "+gmrObj.tchr+" "+gmrObj.frag}else dataError();gmrObj.vocaList.length?(docEl("nextQuestion").style.display="none",docEl("arrayMax").textContent=gmrObj.vocaList.length,grabNewQ(),gmrObj.time=Date.now()):showEmpty(),renderNav(),handlersOn()}function userScored(scr){var score="completed: "+scr+"/"+scr,timeStamp=Date.now(),duration=timeStamp-gmrObj.time;postIt({a:timeStamp,b:gmrObj.tchr,c:gmrObj.clss,d:gmrObj.frag,e:duration,f:document.title,g:score})}function postIt(dataObj){var user=firebase.auth().currentUser,uid=user.uid,postData={email:user.email,timestamp:dataObj.a,tchr:dataObj.b,clss:dataObj.c,frag:dataObj.d,duration:dataObj.e,activity:dataObj.f,score:dataObj.g},newPostKey,updates={};updates["activities/"+uid+"/"+firebase.database().ref().child("activities/"+uid+"/").push().key]=postData,firebase.database().ref().update(updates,(function(e){e?"PERMISSION_DENIED"===e.code?signOutOfApp():window.alert("Data could not be saved.\n"+e):window.alert("Activity completed!")}))}firebase.auth().onAuthStateChanged((function(user){user?(docEl("usrPhoto").src=user.photoURL,init()):window.location="../index.html"}))}()}));